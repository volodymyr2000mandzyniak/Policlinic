<!-- app/views/doctors/sessions/new.html.erb -->
<div class="doctor-login-page">
  <div class="container">
    <div class="row align-items-center g-4 g-lg-5 py-4 py-lg-5">
      <div class="col-lg-7 text-center text-lg-start">
        <div class="doctor-content-wrapper">
          <h1 class="doctor-welcome-title">Професійний портал для лікарів</h1>
          <p class="doctor-description">
            Доступ до ваших медичних інструментів та пацієнтської бази. Увійдіть за допомогою
            вашого номера телефону та паролю для повного доступу до системи.
          </p>
          
          <div class="doctor-benefits mt-4">
            <div class="benefit-card">
              <div class="benefit-icon-wrapper bg-blue-50">
                <i class="fas fa-notes-medical text-blue-600"></i>
              </div>
              <div class="benefit-text">
                <h3>Медичні записи</h3>
                <p>Швидкий доступ до історії хвороб пацієнтів</p>
              </div>
            </div>
            <div class="benefit-card">
              <div class="benefit-icon-wrapper bg-green-50">
                <i class="fas fa-clock text-green-600"></i>
              </div>
              <div class="benefit-text">
                <h3>Розклад прийомів</h3>
                <p>Керування вашим робочим графіком онлайн</p>
              </div>
            </div>
            <div class="benefit-card">
              <div class="benefit-icon-wrapper bg-purple-50">
                <i class="fas fa-prescription-bottle-alt text-purple-600"></i>
              </div>
              <div class="benefit-text">
                <h3>Електронні рецепти</h3>
                <p>Миттєве створення та відправка рецептів</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-10 mx-auto col-lg-5">
        <div class="doctor-login-card">
          <div class="card-header">
            <h2 class="card-title">Вхід для лікарів</h2>
            <p class="card-subtitle">Введіть номер телефону та пароль</p>
          </div>
          <div class="card-body">
            <%= form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %>
              <div class="form-group mb-3">
                <label for="doctorPhone" class="form-label">Номер телефону</label>
                <div class="input-group">
                  <span class="input-group-text">+380</span>
                <%= f.text_field :phone, value: "", class: "form-control", id: "doctorPhone", placeholder: "000000000", maxlength: 9 %>

                </div>
              </div>

              <div class="form-group mb-3">
                <label for="doctorPassword" class="form-label">Пароль</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-lock"></i></span>
                  <%= f.password_field :password, class: "form-control", id: "doctorPassword", placeholder: "••••••••", autocomplete: "current-password" %>
                  <button class="btn btn-outline-secondary password-toggle" type="button">
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
              </div>

              <div class="d-flex justify-content-between align-items-center mb-4">
                <% if devise_mapping.rememberable? %>
                  <div class="form-check">
                    <%= f.check_box :remember_me, class: "form-check-input", id: "rememberMe" %>
                    <label class="form-check-label" for="rememberMe">Запам'ятати мене</label>
                  </div>
                <% end %>
                <%= link_to "Забули пароль?", new_password_path(resource_name), class: "text-sm text-primary-600 hover:text-primary-800" %>
              </div>

              <%= f.button "Увійти", class: "w-100 btn btn-primary btn-lg", type: "submit" %>

              <div class="alternative-options mt-3">
                <p class="text-center text-sm text-gray-600">
                  Немає облікового запису?
                  <%= link_to "Зареєструватись", new_registration_path(resource_name), class: "font-medium text-primary-600 hover:text-primary-800" %>
                </p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('turbo:load', function () {
    document.querySelectorAll('.password-toggle').forEach(button => {
      button.addEventListener('click', function () {
        const input = this.closest('.relative').querySelector('input');
        const icon = this.querySelector('i');

        if (input.type === 'password') {
          input.type = 'text';
          icon.classList.replace('fa-eye', 'fa-eye-slash');
        } else {
          input.type = 'password';
          icon.classList.replace('fa-eye-slash', 'fa-eye');
        }
      });
    });

    const form = document.querySelector('form');
    const phoneInput = document.getElementById('doctorPhone');
    if (form && phoneInput) {
      form.addEventListener('submit', function (e) {
        const digits = phoneInput.value.replace(/\D/g, '');
        if (digits.length === 9) {
          phoneInput.value = '+380' + digits;
        } else if (digits.length === 12 && digits.startsWith('380')) {
          phoneInput.value = '+' + digits;
        } else {
          e.preventDefault();
          alert('Введіть 9 цифр після +380');
          phoneInput.focus();
        }
      });
    }
  });
</script>
